<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ë¬¸ë‘¥ë‹·ì»´ - ì¼ê¸°</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Noto Sans KR', sans-serif;
      background: #f3f4f6;
      padding-top: 4rem; /* ë„¤ë¹„ë°” ë†’ì´ ë§Œí¼ ì—¬ë°± */
    }
    /* í™ˆìœ¼ë¡œ ëŒì•„ê°€ëŠ” ë§í¬ ìŠ¤íƒ€ì¼ */
    .back-link {
      position: absolute;
      top: 1rem;
      left: 1rem;
      background: rgba(255,255,255,0.7);
      padding: 0.5rem 1rem;
      border-radius: 0.375rem;
      font-weight: 500;
      color: #1f2937;
      text-decoration: none;
    }
    .back-link:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <!-- í™ˆìœ¼ë¡œ ëŒì•„ê°€ëŠ” ë§í¬ -->
  <a href="index.html" class="back-link">â† í™ˆìœ¼ë¡œ</a>

  <div class="max-w-2xl mx-auto px-6 py-12">
    <h1 class="text-3xl font-bold text-indigo-600 mb-6">ì˜¤ëŠ˜ì˜ ì¼ê¸°</h1>

    <form id="diary-form" class="space-y-6 bg-white p-6 rounded-lg shadow">
      <!-- ë‚ ì§œ -->
      <div>
        <label class="block text-sm font-medium mb-1">ë‚ ì§œ</label>
        <input type="date" id="date" class="w-full px-4 py-2 border rounded-md" required />
      </div>
      <!-- ê¸°ë¶„ -->
      <div>
        <label class="block text-sm font-medium mb-1">ê¸°ë¶„</label>
        <select id="mood" class="w-full px-4 py-2 border rounded-md">
          <option>ğŸ˜Š í–‰ë³µ</option>
          <option>ğŸ˜ ë³´í†µ</option>
          <option>ğŸ˜¢ ìŠ¬í””</option>
          <option>ğŸ˜  í™”ë‚¨</option>
          <option>ğŸ˜´ í”¼ê³¤</option>
        </select>
      </div>
      <!-- ì‚¬ì§„ ì²¨ë¶€ -->
      <div>
        <label class="block text-sm font-medium mb-1">ì‚¬ì§„ ì²¨ë¶€</label>
        <input type="file" id="photo" accept="image/*" class="w-full" />
        <div id="preview" class="mt-2"></div>
      </div>
      <!-- ë‚´ìš© -->
      <div>
        <label class="block text-sm font-medium mb-1">ë‚´ìš©</label>
        <textarea id="content" rows="6" class="w-full px-4 py-2 border rounded-md" required></textarea>
      </div>
      <button type="submit" class="bg-indigo-600 text-white px-6 py-2 rounded-md hover:bg-indigo-700">ì €ì¥</button>
    </form>

    <div id="saved-entry" class="mt-10 hidden bg-white p-6 rounded-lg shadow">
      <h2 class="text-xl font-bold mb-2">ì €ì¥ëœ ì¼ê¸°</h2>
      <p id="saved-date" class="text-sm text-gray-600"></p>
      <p id="saved-mood" class="mt-2"></p>
      <div id="saved-photo" class="mt-2"></div>
      <p id="saved-content" class="mt-2 whitespace-pre-line"></p>
    </div>
  </div>

  <script>
    const form = document.getElementById('diary-form');
    const preview = document.getElementById('preview');

    // ì‚¬ì§„ ì„ íƒ ì‹œ ë¯¸ë¦¬ë³´ê¸°
    form.photo.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = (event) => {
          preview.innerHTML = `<img src="${event.target.result}" class="w-40 h-40 object-cover rounded" />`;
        };
        reader.readAsDataURL(file);
      } else {
        preview.innerHTML = '';
      }
    });

    // í¼ ì œì¶œ ì‹œ LocalStorageì— ì €ì¥ ë° í™”ë©´ì— í‘œì‹œ
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const entry = {
        date: form.date.value,
        mood: form.mood.value,
        content: form.content.value,
        photo: preview.querySelector('img')?.src || ''
      };
      localStorage.setItem('diaryEntry', JSON.stringify(entry));
      renderSavedEntry();
    });

    // ì €ì¥ëœ ì¼ê¸° ë Œë”ë§
    function renderSavedEntry() {
      const entry = JSON.parse(localStorage.getItem('diaryEntry'));
      if (!entry) return;
      document.getElementById('saved-entry').classList.remove('hidden');
      document.getElementById('saved-date').textContent = `ë‚ ì§œ: ${entry.date}`;
      document.getElementById('saved-mood').textContent = `ê¸°ë¶„: ${entry.mood}`;
      if (entry.photo) {
        document.getElementById('saved-photo').innerHTML = `<img src="${entry.photo}" class="w-40 h-40 object-cover rounded" />`;
      } else {
        document.getElementById('saved-photo').innerHTML = '';
      }
      document.getElementById('saved-content').textContent = entry.content;
    }

    window.addEventListener('DOMContentLoaded', renderSavedEntry);
  </script>
</body>
</html>
